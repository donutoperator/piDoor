
- name: set a hostname
  ansible.builtin.hostname:
    name: pidoor

- name: ensure GUI is disabled
  ansible.builtin.command:
    cmd: systemctl set-default multi-user.target

- name: copy sshd_config
  ansible.builtin.copy:
    dest: "/etc/ssh/sshd_config"
    src: "sshd_config"

- name: copy welcome banner
  ansible.builtin.copy:
    dest: "/etc/welcome-banner"
    src: "welcome-banner"

- name: restart sshd
  ansible.builtin.systemd:
    name: sshd
    state: restarted
    enabled: true

- name: install prerequisited packages
  ansible.builtin.apt:
    name: "{{ item }}"
    update_cache: yes
    allow_unauthenticated: yes
  with_items: 
    - curl
    - mlocate
    - build-essential 
    - gcc 
    - make
    - rustc

- name: create mlocate db
  ansible.builtin.command:
    cmd: updatedb

- name: install python2-pip
  ansible.builtin.command:
    cmd: curl https://bootstrap.pypa.io/pip/2.7/get-pip.py --output get-pip.py; python2 get-pip.py