
- name: Set a hostname
  ansible.builtin.hostname:
    name: pidoor

- name: ensure GUI is disabled
  ansible.builtin.command:
    cmd: systemctl set-default multi-user.target

- name: Copy sshd_config
  ansible.builtin.copy:
    dest: "/etc/ssh/sshd_config"
    src: "sshd_config"

- name: Copy welcome banner
  ansible.builtin.copy:
    dest: "/etc/welcome-banner"
    src: "welcome-banner"

- name: Restart sshd
  ansible.builtin.systemd:
    name: sshd
    state: restarted
    enabled: true

- name: Install kali meta pakages
  ansible.builtin.apt:
    name: "{{ item }}"
    update_cache: yes
    allow_unauthenticated: yes
  with_items: 
    - kali-tools-information-gathering
    - kali-tools-vulnerability
    - kali-tools-web
    - kali-tools-database
    - kali-tools-passwords
    - kali-tools-wireless
    - kali-tools-reverse-engineering
    - kali-tools-exploitation
    - kali-tools-social-engineering
    - kali-tools-sniffing-spoofing
    - kali-tools-post-exploitation
    - kali-tools-forensics
    - kali-tools-reporting
